{% doc %}
  @prompt
    make the component i want get data from page source

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-page-data-extractor-{{ ai_gen_id }} {
    padding: {{ block.settings.padding }}px;
    background-color: {{ block.settings.background_color }};
    border-radius: {{ block.settings.border_radius }}px;
    border: 1px solid {{ block.settings.border_color }};
  }

  .ai-page-data-header-{{ ai_gen_id }} {
    margin-bottom: 20px;
  }

  .ai-page-data-title-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-size: {{ block.settings.title_size }}px;
    margin: 0 0 10px 0;
    font-weight: 600;
  }

  .ai-page-data-description-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    opacity: 0.8;
    margin: 0 0 15px 0;
  }

  .ai-page-data-filters-{{ ai_gen_id }} {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .ai-page-data-filter-btn-{{ ai_gen_id }} {
    padding: 8px 16px;
    background-color: {{ block.settings.filter_bg_color }};
    color: {{ block.settings.filter_text_color }};
    border: 1px solid {{ block.settings.filter_border_color }};
    border-radius: {{ block.settings.button_border_radius }}px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .ai-page-data-filter-btn-{{ ai_gen_id }}:hover,
  .ai-page-data-filter-btn-{{ ai_gen_id }}.active {
    background-color: {{ block.settings.filter_active_bg_color }};
    color: {{ block.settings.filter_active_text_color }};
  }

  .ai-page-data-content-{{ ai_gen_id }} {
    display: grid;
    gap: 15px;
  }

  .ai-page-data-section-{{ ai_gen_id }} {
    padding: 15px;
    background-color: {{ block.settings.section_bg_color }};
    border-radius: {{ block.settings.section_border_radius }}px;
    border-left: 4px solid {{ block.settings.accent_color }};
  }

  .ai-page-data-section-title-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-size: 16px;
    font-weight: 600;
    margin: 0 0 10px 0;
  }

  .ai-page-data-item-{{ ai_gen_id }} {
    margin-bottom: 8px;
    padding: 8px 0;
    border-bottom: 1px solid {{ block.settings.border_color }};
  }

  .ai-page-data-item-{{ ai_gen_id }}:last-child {
    border-bottom: none;margin-bottom: 0;
  }

  .ai-page-data-label-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    font-weight: 500;
    font-size: 14px;
    display: inline-block;
    min-width: 120px;
  }

  .ai-page-data-value-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
    opacity: 0.9;
    font-size: 14px;
    word-break: break-word;
  }

  .ai-page-data-code-{{ ai_gen_id }} {
    background-color: {{ block.settings.code_bg_color }};
    color: {{ block.settings.code_text_color }};
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
    font-size: 12px;
  }

  .ai-page-data-empty-{{ ai_gen_id }} {
    text-align: center;
    color: {{ block.settings.text_color }};
    opacity: 0.6;
    padding: 40px 20px;
    font-style: italic;
  }

  @media screen and (max-width: 749px) {
    .ai-page-data-filters-{{ ai_gen_id }} {
      flex-direction: column;
    }

    .ai-page-data-filter-btn-{{ ai_gen_id }} {
      width: 100%;
      text-align: center;
    }
  }
{% endstyle %}

<page-data-extractor-{{ ai_gen_id }}
  class="ai-page-data-extractor-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-page-data-header-{{ ai_gen_id }}">
    {% if block.settings.title != blank %}
      <h2 class="ai-page-data-title-{{ ai_gen_id }}">{{ block.settings.title }}</h2>
    {% endif %}
    {% if block.settings.description != blank %}
      <div class="ai-page-data-description-{{ ai_gen_id }}">{{ block.settings.description }}</div>
    {% endif %}
  </div>

  <div class="ai-page-data-filters-{{ ai_gen_id }}"><button class="ai-page-data-filter-btn-{{ ai_gen_id }} active" data-filter="all">All Data</button>
    <button class="ai-page-data-filter-btn-{{ ai_gen_id }}" data-filter="page-info">Page Info</button>
    <button class="ai-page-data-filter-btn-{{ ai_gen_id }}" data-filter="meta-tags">Meta Tags</button>
    <button class="ai-page-data-filter-btn-{{ ai_gen_id }}" data-filter="content">Content</button>
    <button class="ai-page-data-filter-btn-{{ ai_gen_id }}" data-filter="shopify-data">Shopify Data</button>
  </div>

  <div class="ai-page-data-content-{{ ai_gen_id }}">
    <div class="ai-page-data-section-{{ ai_gen_id }}" data-category="page-info">
      <h3 class="ai-page-data-section-title-{{ ai_gen_id }}">Page Information</h3>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Page Title:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ page_title | escape }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Page URL:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ canonical_url }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Template:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }} ai-page-data-code-{{ ai_gen_id }}">{{ template.name }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Handle:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }} ai-page-data-code-{{ ai_gen_id }}">
          {% if page %}{{ page.handle }}{% elsif product %}{{ product.handle }}{% elsif collection %}{{ collection.handle }}{% elsif blog %}{{ blog.handle }}{% elsif article %}{{ article.handle }}{% else %}N/A{% endif %}
        </span>
      </div></div>

    <div class="ai-page-data-section-{{ ai_gen_id }}" data-category="meta-tags">
      <h3 class="ai-page-data-section-title-{{ ai_gen_id }}">Meta Information</h3>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Meta Title:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ page_title | escape }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Meta Description:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">
          {% if page_description != blank %}{{ page_description | escape }}{% else %}Not set{% endif %}
        </span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Language:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }} ai-page-data-code-{{ ai_gen_id }}">{{ request.locale.iso_code }}</span>
      </div>
    </div>

    <div class="ai-page-data-section-{{ ai_gen_id }}" data-category="content">
      <h3 class="ai-page-data-section-title-{{ ai_gen_id }}">Content Data</h3>
      {% if page %}
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Page Content:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ page.content | strip_html | truncate: 200 }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Created:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ page.created_at | date: '%B %d, %Y' }}</span>
        </div>{% elsif product %}
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Product Type:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ product.type }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Vendor:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ product.vendor }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Tags:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ product.tags | join: ', ' }}</span>
        </div>{% elsif collection %}
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Products Count:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ collection.products_count }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Description:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ collection.description | strip_html | truncate: 200 }}</span>
        </div>
      {% elsif article %}
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Author:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ article.author }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Published:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ article.published_at | date: '%B %d, %Y' }}</span>
        </div>
        <div class="ai-page-data-item-{{ ai_gen_id }}">
          <span class="ai-page-data-label-{{ ai_gen_id }}">Summary:</span>
          <span class="ai-page-data-value-{{ ai_gen_id }}">{{ article.summary | strip_html | truncate: 200 }}</span>
        </div>
      {% endif %}
    </div>

    <div class="ai-page-data-section-{{ ai_gen_id }}" data-category="shopify-data">
      <h3 class="ai-page-data-section-title-{{ ai_gen_id }}">Shopify Environment</h3>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Shop Name:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ shop.name }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Shop Domain:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ shop.domain }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Currency:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }} ai-page-data-code-{{ ai_gen_id }}">{{ cart.currency.iso_code }}</span>
      </div>
      <div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Customer Logged In:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">
          {% if customer %}Yes ({{ customer.email }}){% else %}No{% endif %}
        </span>
      </div><div class="ai-page-data-item-{{ ai_gen_id }}">
        <span class="ai-page-data-label-{{ ai_gen_id }}">Cart Items:</span>
        <span class="ai-page-data-value-{{ ai_gen_id }}">{{ cart.item_count }}</span>
      </div>
    </div>
  </div>
</page-data-extractor-{{ ai_gen_id }}><script>
  (function() {
    class PageDataExtractor{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.filterButtons = this.querySelectorAll('.ai-page-data-filter-btn-{{ ai_gen_id }}');
        this.sections = this.querySelectorAll('.ai-page-data-section-{{ ai_gen_id }}');
        this.setupEventListeners();
      }

      setupEventListeners() {
        this.filterButtons.forEach(button => {
          button.addEventListener('click', () => {
            const filter = button.getAttribute('data-filter');
            this.filterContent(filter);
            this.updateActiveButton(button);
          });
        });
      }

      filterContent(filter) {
        this.sections.forEach(section => {
          const category = section.getAttribute('data-category');
          if (filter === 'all' || filter === category) {
            section.style.display = 'block';
          } else {
            section.style.display = 'none';
          }
        });
      }

      updateActiveButton(activeButton) {
        this.filterButtons.forEach(button => {
          button.classList.remove('active');
        });
        activeButton.classList.add('active');
      }
    }

    customElements.define('page-data-extractor-{{ ai_gen_id }}', PageDataExtractor{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Page data extractor",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Page Data Inspector"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "View and analyze data from the current page source"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent",
      "default": "#007acc"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section background",
      "default": "#f8f9fa"
    },
    {
      "type": "header",
      "content": "Filter buttons"
    },
    {
      "type": "color",
      "id": "filter_bg_color",
      "label": "Background",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "filter_text_color",
      "label": "Text",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "filter_border_color",
      "label": "Border",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "filter_active_bg_color",
      "label": "Active background",
      "default": "#007acc"
    },
    {
      "type": "color",
      "id": "filter_active_text_color",
      "label": "Active text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Code display"
    },
    {
      "type": "color",
      "id": "code_bg_color",
      "label": "Code background",
      "default": "#f4f4f4"
    },
    {
      "type": "color",
      "id": "code_text_color",
      "label": "Code text",
      "default": "#d63384"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "padding",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Padding",
      "default": 30
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "section_border_radius",
      "min": 0,
      "max": 15,
      "step": 1,
      "unit": "px",
      "label": "Section border radius",
      "default": 6
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Button border radius",
      "default": 6
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 16,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 24
    }
  ],
  "presets": [
    {
      "name": "Page data extractor"
    }
  ],
  "tag": null
}
{% endschema %}